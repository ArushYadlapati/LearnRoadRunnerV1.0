(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{355:function(t,e,s){},418:function(t,e,s){"use strict";s(355)},431:function(t,e,s){"use strict";s.r(e);var i,a=s(0),r=s(351);class o{constructor(t,e,s){this.lastTime=0,this.lastError=0,this.errorSum=0,this.lowerBound=0,this.upperBound=0,this.isBounded=!1,this.firstUpdate=!1,this.kP=t,this.kI=e,this.kD=s}setBounds(t,e){this.lowerBound=t,this.upperBound=e,this.isBounded=!0}update(t){if(!this.firstUpdate)return this.lastTime=performance.now(),this.lastError=t,this.firstUpdate=!0,0;const e=performance.now(),s=e-this.lastTime;this.errorSum+=.5*(t+this.lastError)*s;const i=(t-this.lastError)/s;this.lastError=t,this.lastTime=e;const a=t*this.kP+i*this.kD+this.errorSum*this.kI;return this.isBounded?Math.max(this.lowerBound,Math.min(this.upperBound,a)):a}reset(){this.errorSum=0}}!function(t){t[t.Accel=0]="Accel",t[t.Coast=1]="Coast",t[t.Decel=2]="Decel"}(i||(i={}));var n=a.a.extend({props:{graphHeight:{type:String,default:"30rem"}},computed:{uuid:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},data:()=>({graphData:[[],[],[]],plot:null,resizeObserver:null,paddingX:-0,paddingY:-40,maxDataLength:200,maxVel:50,maxAccel:50,coastingLength:1e3,maxVelPadding:20,targetVelocity:0,startTime:0,lastLoopTime:0,coastStart:0,currentVelocity:0,kP:0,kI:0,kD:0,kF:.01,arbitraryScalingKp:1/1600,arbitraryScalingKi:.001,arbitraryScalingKd:1e-6,setVoltage:0,controller:new o(0,0,0),modelKV:.0153,modelKA:.001,modelKStatic:.0021,lastState:i.Accel,currentState:i.Accel}),mounted(){let t={title:"",width:this.$refs.canvas.clientWidth+this.paddingX,height:this.$refs.canvas.clientHeight+this.paddingY,series:[{label:"time"},{label:"targetVelocity",scale:"%",width:2,stroke:"green"},{label:"velocity0",scale:"%",width:2,stroke:"red"}],scales:{x:{time:!1},"%":{auto:!1,range:(t,e)=>[-this.maxVel-this.maxVelPadding,this.maxVel+this.maxVelPadding]}},axes:[{label:"time elapsed (seconds)"},{scale:"%",label:"velocity (inches per second)"}],cursor:{drag:{setScale:!1,x:!1,y:!1}}};this.controller.setBounds(-1,1),this.startTime=performance.now(),this.loop(),this.plot=new r.a(t,JSON.parse(JSON.stringify(this.graphData)),this.$refs.canvas),this.resizeObserver=new ResizeObserver(t=>{for(let e of t)e.target==this.$refs.canvas&&this.plot.setSize({width:e.contentRect.width+this.paddingX,height:e.contentRect.height+this.paddingY})}),this.resizeObserver.observe(this.$refs.canvas)},beforeDestroy(){this.resizeObserver.disconnect()},methods:{loop(){const t=performance.now();this.graphData[0].push((t-this.startTime)/1e3);const e=(t-this.lastLoopTime)/1e3;switch(this.currentState){case i.Accel:this.targetVelocity=Math.min(this.targetVelocity+this.maxAccel*e,this.maxVel),this.targetVelocity>=this.maxVel&&(this.coastStart=t,this.lastState=i.Accel,this.currentState=i.Coast),this.graphData[1].push(this.targetVelocity);break;case i.Coast:t-this.coastStart>=this.coastingLength&&(this.lastState==i.Accel?this.currentState=i.Decel:this.lastState==i.Decel&&(this.currentState=i.Accel),this.lastState=i.Coast),this.graphData[1].push(this.targetVelocity);break;case i.Decel:this.targetVelocity=Math.max(this.targetVelocity-this.maxAccel*e,-this.maxVel),this.targetVelocity<=-this.maxVel&&(this.coastStart=t,this.lastState=i.Decel,this.currentState=i.Coast),this.graphData[1].push(this.targetVelocity)}this.currentVelocity+=(-this.modelKV/this.modelKA*this.currentVelocity+1/this.modelKA*this.setVoltage)*e||0,this.currentVelocity=Math.max(Math.min(this.currentVelocity,1.3*this.maxVel),1.3*-this.maxVel),this.setVoltage=this.controller.update(this.targetVelocity-this.currentVelocity)+this.kF*this.targetVelocity,this.graphData[2].push(this.currentVelocity),this.graphData[0].length>this.maxDataLength&&(this.graphData[0].shift(),this.graphData[1].shift(),this.graphData[2].shift()),null!=this.plot&&this.plot.setData(this.graphData),this.lastLoopTime=t,setTimeout(this.loop,1e3/24+50*Math.random())},setP(){this.controller.kP=this.kP*this.arbitraryScalingKp},setI(){this.controller.kI=this.kI*this.arbitraryScalingKi,this.controller.reset()},setD(){this.controller.kD=this.kD*this.arbitraryScalingKd},setF(){this.controller.kF=Math.min(this.kF,.014)},reset(){this.graphData[0]=[],this.graphData[1]=[],this.graphData[2]=[],this.startTime=performance.now(),this.currentVelocity=0,this.targetVelocity=0,this.currentState=i.Accel,this.controller.reset()}}}),l=(s(352),s(418),s(46)),c=Object(l.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tuning-simulator border-gray-500 border rounded-lg overflow-hidden"},[s("div",{ref:"canvas",staticClass:"bg-gray-100",staticStyle:{"box-shadow":"rgba(0, 0, 0, 0.1) 0px 2px 6px 2px inset"},style:{height:t.graphHeight}}),t._v(" "),s("div",{staticClass:"bg-gray-200 rounded-b-lg px-4 py-3 border-t border-gray-400 grid grid-cols-4 gap-2"},[s("div",{staticClass:"flex flex-col items-center"},[s("label",{staticClass:"mb-1 ml-1",attrs:{for:"kp-input-"+t.uuid}},[t._v("kP")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.kP,expression:"kP",modifiers:{number:!0}}],staticClass:"box-border text-center shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",attrs:{id:"kp-input-"+t.uuid},domProps:{value:t.kP},on:{change:t.setP,input:function(e){e.target.composing||(t.kP=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"flex flex-col items-center"},[s("label",{staticClass:"mb-1 ml-1",attrs:{for:"ki-input-"+t.uuid}},[t._v("kI")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.kI,expression:"kI",modifiers:{number:!0}}],staticClass:"box-border text-center shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",attrs:{id:"ki-input-"+t.uuid},domProps:{value:t.kI},on:{change:t.setI,input:function(e){e.target.composing||(t.kI=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"flex flex-col items-center"},[s("label",{staticClass:"mb-1 ml-1",attrs:{for:"kd-input-"+t.uuid}},[t._v("kD")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.kD,expression:"kD",modifiers:{number:!0}}],staticClass:"box-border text-center shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",attrs:{id:"kD-input-"+t.uuid},domProps:{value:t.kD},on:{change:t.setD,input:function(e){e.target.composing||(t.kD=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"flex flex-col items-center"},[s("label",{staticClass:"mb-1 ml-1",attrs:{for:"kf-input-"+t.uuid}},[t._v("kF")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.kF,expression:"kF",modifiers:{number:!0}}],staticClass:"box-border text-center shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",attrs:{id:"kf-input-"+t.uuid},domProps:{value:t.kF},on:{change:t.setF,input:function(e){e.target.composing||(t.kF=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"col-span-2 col-start-2 flex justify-center"},[s("button",{staticClass:"mt-3 bg-white hover:bg-gray-100 text-gray-800 font-semibold py-2 px-4 border border-gray-400 rounded outline-none focus:shadow-outline",on:{click:t.reset}},[t._v("\n        Reset\n      ")])])])])}),[],!1,null,null,null);e.default=c.exports}}]);